## -*- mode:ulam -*-
#=t41308_test_compiler_elementandquark_multibases_virtualfuncsselect_error
#!
./Foo.ulam:14:15: ERROR: Selected Base Class Type QBase1 is not a direct ancestor of E4 and cannot be used in this context.
./Foo.ulam:14:22: ERROR: Member selected is incomplete class: erroneous, check and label fails this time around.
./Foo.ulam:14:10: ERROR: Assignment is invalid; LHS: Int(32); RHS: erroneous.
Unrecoverable Program Type Label FAILURE.
##
##       informed by t41307; requiring direct ancestor (see also t41308)
##
#>Foo.ulam
  ulam 4;
element Foo +System {
  Int m_c4;
  Int m_a4;

  Int test()
  {
    E4 e4;

    m_c4 = e4.QBase2.vfuncc(); //212
    print(m_c4);
    assert(m_c4==212);

    m_a4 = e4.QBase1.vfunca(); //110 use QBase3 instead
    print(m_a4);
    assert(m_a4==110);
    return 0;
  }
}


#:E4.ulam
  ulam 4;
element E4 : QBase3 +QBase2 {
  virtual Int vfuncc() { return 412; }
  virtual Int vfunca() { return 410; }
  virtual Void behave() { }
}

#:QBase1.ulam
    ulam 4;
quark QBase1 {
  Bool m_b1;
  Void funcNotVirtualSoIrrelevantHere() { }
  //virtual Int vfuncb() { return 111; }   ambiguous (see t41305)
  virtual Int vfunca() { return 110; }
}

#:QBase2.ulam
  ulam 4;
quark QBase2 {
  Bool m_b2;
  virtual ARGB getColor(Unsigned s) { return super.getColor(s); }
  //virtual Int vfunca() { return 210; }
  virtual Int vfuncc() { return 212; }
}

#:QBase3.ulam
  ulam 4;
quark QBase3 +QBase1 {
  Bool m_b3;
  virtual Int vfuncb() { return 311; }
}


#:System.ulam
ulam 1;
quark System {
Void print(Unsigned arg) native;
Void print(Int arg) native;
Void print(Int(4) arg) native;
Void print(Int(3) arg) native;
Void print(Unary(3) arg) native;
Void print(Bool(3) arg) native;
Void assert(Bool b) native;
}

#.
