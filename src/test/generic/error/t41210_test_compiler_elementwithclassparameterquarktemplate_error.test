## -*- mode:ulam -*-
#=t41210_test_compiler_elementwithclassparameterquarktemplate_error
#!
./T.ulam:6:13: ERROR: Class argument 'v' not statisfied by expression type: Q(true).
./T.ulam:13:12: ERROR: Class argument 'v' not statisfied by expression type: Q(false).
Unrecoverable Program Type Label FAILURE.
##
##    //informed by t41209
##
#>T.ulam
 ulam 3;
element T{
  Int test(){
    System sys;
    constant Q(true) cq = { .i = 7};
    S(false,cq) s; //THIS SHOULDN'T WORK since cq is a Q(true), not a Q(false)!
    sys.print(s.csi);
    sys.assert(s.csi == 7);
    sys.print(s.v.b);
    sys.assert(s.v.b); //true

    constant Q(false) cqf = { .i = 3};
    S(true,cqf) sf;
    sys.print(sf.csi);
    sys.assert(sf.csi == 3);
    sys.print(sf.v.b);
    sys.assert(!sf.v.b); //false

    return s.csi; //7
  }
}

#:S.ulam
  ulam 3;
quark S(Bool bp, Q(bp) v){
  constant Int(4) csi = v.i; //we're all constants here, right?
}

#:Q.ulam
  ulam 1;
quark Q(Bool flag){
  Bool b = flag;
  Int(4) i;
}

#:System.ulam
ulam 1;
quark System {
Void print(Unsigned arg) native;
Void print(Int arg) native;
Void print(Int(4) arg) native;
Void print(Int(3) arg) native;
Void print(Unary(3) arg) native;
Void print(Bool(3) arg) native;
Void assert(Bool b) native;
}
#.
