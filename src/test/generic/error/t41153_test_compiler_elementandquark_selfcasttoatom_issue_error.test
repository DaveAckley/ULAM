## -*- mode:ulam -*-
#=t41153_test_compiler_elementandquark_selfcasttoatom_issue_error
#!
./MyElement.ulam:18:15: ERROR: Cannot explicitly cast QOne(10u)& to type: Atom(96); Consider using a reference (or self) with .atomof.
./MyElement.ulam:18:5: ERROR: Initial value expression for: a, initialization is invalid.
Unrecoverable Program Type Label FAILURE.
##
## informed by user ish 11/5/2017:
## (see also t3905)
##
#>MyElement.ulam
  ulam 3;
element MyElement : QOne(10)
{
  Int test()
  {
    Atom abc = self;
    behave();
    return 0;
  }
}

quark QOne(Unsigned num)
{
  Void behave(){
    Atom atom = self.atomof; //ok
    Atom aok = self.instanceof; //ok

    Atom a = (Atom) self; //NO GOOD. supercedes all other WAIT messages!

    //WAIT messages squashed by ERR message for line above. comment out to see these..
    QOne(num) & qref = self;
    Atom b = (Atom) qref; //NO GOOD.
    Atom& atref = (Atom &) qref; //NO GOOD;
    //    QOne & badref = self; //missing class arg, caused assert (see t41155)
  }
}
